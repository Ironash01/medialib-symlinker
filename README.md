# Project is being discontinued.

Probably no one cares, but this bash script took a lot of effort to make, and though I wasn't skilled in programming yet I managed to achieve some features I wanted.
The very problem is that as basic features is one thing but as I progressed into developing the program more and adding more functions I realized that I needed an actual programming language
and a user interface if I wanted to continue developing this project.

As much as it pains me, this project will be discontinued in favor of the next medialib-symlinker, which I plan to be more advanced and easier to manage.

I will not stop until I develop the software I want and make it work the way I want it to. :)

# Media Library Symlinker

The purpose of this bash script is to create symlinks for media files.

The filenaming convention used in symlinked files follow the kodi standard.

***https://kodi.wiki/view/Naming_video_files***

You can then use softwares likes tinyMediaManager to create metadata for your library or directly add the source to kodi and use the built-in scrapers.

**Specials are not supported yet, they will be placed in the "Extras" folder**

**Main episodes works fine**

# Overview of usage

```bash
Usage: medialib [OPTIONS]

Options:
        -h                      Print this help and exit.
        -a                      Equivalent of -c and -r
        -w                      Write list in ~/.config/medialib/.tv-list.
        -c                      Create symlinks in specified directory.
        -r                      Rename the video files inside the symlinks.
        -d <directory>          Define symlink directory.
        -e                      Edit various configs.
        -i <tv|mov>             Set library mode.
        -s <directory>          Add Parent source.
        -S <directory>          Remove Parent source.
        -l                      List infortmations: directories and sources.
        -u                      Updates keywords (no overwrite)

Setup custom-rename file in "~/.config/medialib" for custom renaming afterwards
Setup custom-special file in ~/.config/medialib for Special episodes in TV Shows
 ```

 *THIS IS TOO CONFUSING I JUST WANT RESULTS!!*

 Below is an example scenario of me adding my anime collection.

 First run the initial command without options. This will check for dependencies and create configs.

```
medialib
```
```
medialib -i tv
```

You need to add the parent source.
```
e.g.
parent_source/
└── folder_of_anime
    ├── grumbledfilename_01.mkv
    ├── grumbledfilename_02.mkv
    └── grumbledfilename_03.mkv
```

```
medialib -s /media/daleminty/hdd00/Videos/AnimeBD
```
Now I want to store the results of the symlinks to my ~/Videos/tv_shows_link
```
medialib -d ~/Videos/tv_shows_link
```
I then need to write tv-list
```
medialib -w 
```
The output should be something like this:
```console
daleminty@daleminty-Nitro-AN515-58$ ./medialib.sh -w

Processing to search tmdb: Engage%20Kiss
Engage Kiss (2022)
Processing to search tmdb: Golden%20Time
Golden Time (2013)
Processing to search tmdb: Magi%20The%20Kingdom%20of%20Magic
Magi (2012)
file keyword : Magi.* The Kingdom of Magic
search_season1:                   <h2><a href="/tv/60654/season/1">Magi: The Labyrinth of Magic</a></h2>
                  <h2><a href="/tv/60654/season/2">Magi: The Kingdom of Magic</a></h2>
search_season final : 2
Processing to search tmdb: Love%2C%20Chunibyo%20%26%20Other%20Delusions%21
Love, Chunibyo Other Delusions (2012)
Processing to search tmdb: Love%2C%20Chunibyo%20%26%20Other%20Delusions%21%20Heart%20Throb
Love, Chunibyo Other Delusions (2012)

```
I will then create symlinks and rename them
```
medialib -a
```

There you go. You just created, symlinks for your media library

For movies you can replicate the process but first you need to run
```
medialib -i mov
```

# What file to get?

~~the **"medialib"** in the root of this repo, development codes are in the **code/**~~


~~by default medialib stores it's config files in `~/.config/medialib`~~

Clone the entire repo and run **medialib.sh** inside code/

Below is a list of files this script needs

* **medialibrc**
* **tv-list**
* **mov-list**

tv-list and mov-list can be generated by using -w see overview of usage.


# File naming conventions

Edit the filenaming-rule, as basis I created a file called **_releases-convention.txt_** which describes directory structure and file naming used by several anime releasers.

For TV Shows the original structure and file naming is pretty simple among all releasers to not warrant a list.

Movies are also pretty simple. Search for the mkv file then search for audio file with matching name with main mkv file and put everything else inside the **Extras** folder.

# Extras folder

By default kodi searches for every sub-folders inside your parent source.
But if we set-up an advancedsettings.xml file kodi will ignore the Extras folder

```html

<advancedsettings version="1.0">
   <video>
      <excludefromscan>
          <regexp>[-\._ ](extrafanart|sample|trailer|extrathumbs)[-\._ ]</regexp>
      </excludefromscan>
      <excludefromlisting>
          <regexp>[-._ \\/](extrafanart|sample|trailer|extrathumbs)[-._ \\/]</regexp>
      </excludefromlisting>
      <!-- Extras: Section Start -->
      <excludefromscan action="append">
          <regexp>/extras/</regexp>
          <regexp>[\\/]extras[\\/]</regexp>
      </excludefromscan>
      <excludetvshowsfromscan action="append">
          <regexp>/extras/</regexp>
          <regexp>[\\/]extras[\\/]</regexp>
      </excludetvshowsfromscan>
      <!-- Extras: Section End -->
   </video>
 </advancedsettings>
 
```

Furthermore, by downloading the **"Extras"** addon users will be given a context-menu option to browse the contents of the Extras folder.

For information about the addon and instruction on how to create advancedsettings.xml
Refer to:

***https://kodi.wiki/view/Add-on:Extras***

# Supported file formats?

Yes there is a set of formats that will only work. Nothing really fancy, they're all stored in an array so adding them is a matter of seconds but I targeted only the necessary ones.

As of March 10,2023 the symlinker supports:

1.External subs and audio for movies.

2.External subs for tv shows.

External Audio files

* .aac
* .ac3
* .dts
* .wma
* .mp3
* .flac

External Subtitles

* .ass
* .ssa
* .srt
* .pgs
* .sup

There is a need for limiting the file extensions. It limits the scope of what I have to take into account for and ensures that only the necessary files will get scanned by the script.

# Why create a symlink instead?

Simple answer: Torrenting.

Some torrent clients have built-in file renamers but they are tedious to use when batch renaming, some do support scripting but requires setting up.

I wanted a solution to automatically rename the files, but still be able to seed them. At that point I stumbled upon "Symbolink Links"

# Mode of the script

You can set the mode using

```bash
medialib -i \<mode>
```
e.g.:

```bash
medialib -i tv

#OR

medialib -i mov
```

There are only two modes. please check your current mode before running options like -w and -c

To check your mode:

```bash
medialib -l
```

# Process of the script, simplified

1.Set mode

2.Set Symlink parent directory

3.Add sources

4.Write a list of the shows including their season numbers available, use a web scraper to determine the name of the show in TMDB

5.Create symlinks using the list

6.Rename the video files using the scraped information from TMDB

There are more details petertaining to the process, it is not magic. The script needs to be provided with strings to check and compare it with results from a tmdb search.

tv mode and mov mode are different

# Problems

DanMachi - Needs custom-search

Kakegurui - needs custom-search

Magi - Keyword 'Magi' returns incorrect result, must name it 'Magi The Labyrinth of Magic'
